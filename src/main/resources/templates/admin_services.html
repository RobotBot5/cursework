<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Services List</title>
</head>
<body>
<form action="#" th:action="@{/admin/services/new-service}" th:object="${service}" method="POST">
    <select th:field="*{serviceType}">
        <option th:each="type : ${T(com.rtumirea.KazakovIG.cursework.domain.enums.ServiceType).values()}"
                th:value="${type}" th:text="${serviceTypeNames[__${type}__]}"></option>
    </select>
    <input type="text" th:field="*{name}" placeholder="Введите название услуги" required>
    <input type="number" th:field="*{price}" placeholder="Введите цену услуги" required>
    <div th:if="${error_service_name}" style="color: red;" th:text="${error_service_name}"></div>
    <button type="submit">Добавить услугу</button>
</form>

<form action="#" th:action="@{/admin/services/delete-service}" method="POST">
    <select name="deletable_service_name">
        <option disabled selected th:value="error">Выберите услугу</option>
        <th:block th:each="entry : ${servicesByType}">
            <option disabled th:text="'--' + ${serviceTypeNames[__${entry.key}__]} + '--'"></option>
            <th:block th:each="service : ${entry.value}">
                <option th:value="${service.name}" th:text="${service.name}"></option>
            </th:block>
        </th:block>
    </select>
    <div th:if="${error_delete_service}" style="color: red;" th:text="${error_delete_service}"></div>
    <button type="submit">Удалить сервис</button>
</form>

<form action="#" th:action="@{/admin/services/update-cost}" method="POST">
    <select name="updatable_service_name">
        <option disabled selected th:value="error">Выберите услугу</option>
        <th:block th:each="entry : ${servicesByType}">
            <option disabled th:text="'--' + ${serviceTypeNames[__${entry.key}__]} + '--'"></option>
            <th:block th:each="service : ${entry.value}">
                <option th:value="${service.name}" th:text="${service.name}"></option>
            </th:block>
        </th:block>
    </select>
    <input type="number" name="updatable_service_price" placeholder="Введите новую цену услуги" required>
    <div th:if="${error_update_service}" style="color: red;" th:text="${error_update_service}"></div>
    <button type="submit">Обновить цену услуги</button>
</form>

<div align="center" th:each="entry : ${servicesByType}">
    <h2 th:text="${serviceTypeNames[__${entry.key}__]}"></h2>
    <table>
        <thead>
        <tr>
            <th>Название услуги</th>
            <th>Цена услуги</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="service : ${entry.value}">
            <td>
                <span th:if="${service.deletable}">
                    <s th:text="${service.name}"></s>
                </span>
                <span th:unless="${service.deletable}" th:text="${service.name}"></span>
                <form th:if="${service.deletable}" th:action="@{/admin/services/delete-finally}" method="POST">
                    <button type="submit" name="finallyDeletableServiceId" th:value="${service.id}">Окончательно удалить услугу</button>
                </form>
                <form th:if="${service.deletable}" th:action="@{/admin/services/undelete-service}" method="POST">
                    <button type="submit" name="unDeleteServiceId" th:value="${service.id}">Отменить удаление</button>
                </form>
            </td>
            <td th:text="${service.price}"><s th:if="${service.deletable}"></s></td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>